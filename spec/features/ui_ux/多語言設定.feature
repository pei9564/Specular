Feature: 多語言設定
  支援繁體中文與 English 切換，並處理國際化 (i18n) 相關邏輯

  Background:
    Given 系統支援的語言代碼為:
      | code  | name     |
      | zh-TW | 繁體中文 |
      | en    | English  |
    And 系統預設語言為 "zh-TW"
  # ============================================================
  # Rule: 語言切換
  # ============================================================

  Rule: 用戶可以在支援的語言之間進行切換

    Example: 切換至英文
      Given 當前語言為 "zh-TW"
      When 用戶將語言設定切換為 "en"
      Then 介面所有文字標籤應即時更新為英文
      And 用戶偏好 "language" 應更新為 "en" 並儲存至 localStorage
      And HTML 的 lang 屬性應更新為 "en"

    Example: 切換至繁體中文
      Given 當前語言為 "en"
      When 用戶將語言設定切換為 "zh-TW"
      Then 介面所有文字標籤應即時更新為繁體中文
      And 用戶偏好 "language" 應更新為 "zh-TW" 並儲存至 localStorage
      And HTML 的 lang 屬性應更新為 "zh-TW"
  # ============================================================
  # Rule: 預設語言偵測
  # ============================================================

  Rule: 首次訪問時，系統應嘗試偵測用戶偏好語言

    Example: 偵測瀏覽器語言 (繁體中文)
      Given 用戶首次訪問（無儲存偏好）
      And 用戶瀏覽器的 `navigator.language` 為 "zh-TW" 或 "zh-HK"
      Then 系統應自動設定語言為 "zh-TW"

    Example: 偵測瀏覽器語言 (英文)
      Given 用戶首次訪問（無儲存偏好）
      And 用戶瀏覽器的 `navigator.language` 為 "en-US" 或 "en-GB"
      Then 系統應自動設定語言為 "en"

    Example: 未知語言時使用預設值
      Given 用戶首次訪問
      And 用戶瀏覽器語言為系統不支援的語言 (如 "fr-FR")
      Then 系統應使用預設語言 "zh-TW"
  # ============================================================
  # Rule: 動態內容翻譯
  # ============================================================

  Rule: 系統產生的動態內容應盡可能配合當前語言設定

    Example: 錯誤訊息本地化
      Given 當前語言為 "en"
      When 系統發生 "網路由錯誤"
      Then 錯誤提示應顯示 "Network Error" 而非 "網路錯誤"

    Example: 日期與時間格式化
      Given 當前語言為 "zh-TW"
      When 顯示時間 "2024-02-05 14:30:00"
      Then 應依循台灣習慣格式 (如 "2024/02/05 下午 02:30")

    Example: 數字格式化
      Given 當前語言為 "en"
      When 顯示金額 "10000"
      Then 應顯示為 "10,000"
  # ============================================================
  # Rule: 缺字處理 (Fallback)
  # ============================================================

  Rule: 當翻譯資源缺失時，應有備援機制

    Example: 英文翻譯缺失
      Given 當前語言為 "en"
      When 介面嘗試顯示一個尚未翻譯的 key "new_feature_label"
      Then 系統應退回到預設語言 "zh-TW" 的翻譯內容
